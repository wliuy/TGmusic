export async function onRequest(c){const {request,env}=c,url=new URL(request.url),f=url.searchParams.get('file_id'),a=url.searchParams.get('auth'),t=env.TG_Bot_Token;if((env.PASSWORD&&a!==env.PASSWORD)||!f||!t)return new Response("Unauthorized",{status:401});try{const i=await(await fetch("https://api.telegram.org/bot"+t+"/getFile?file_id="+f)).json();if(!i.ok)return new Response("TG Error",{status:400});const d="https://api.telegram.org/file/bot"+t+"/"+i.result.file_path,r=request.headers.get('Range'),res=await fetch(d,{headers:r?{Range:r}:{}});const h=new Headers(res.headers);h.set('Access-Control-Allow-Origin','*');h.set('Cache-Control','public,max-age=31536000');return new Response(res.body,{status:res.status,headers:h});}catch(e){return new Response("Error",{status:500});}}